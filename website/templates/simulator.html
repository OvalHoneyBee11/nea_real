{% extends "base.html" %}

{% block title %}Economic Simulator{% endblock %}

{% block content %}
<!-- Load KineticGraphs CSS and JS -->
<link rel="stylesheet" href="https://kineticgraphs.org/css/kg.0.2.6.css">
<script src="https://kineticgraphs.org/js/kg.0.2.6.js"></script>

<style>
    body {
        font-family: Arial, sans-serif;
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
    }
    h1 {
        color: #333;
    }
    .test-box {
        background: #f0f0f0;
        padding: 10px;
        margin: 10px 0;
        border-radius: 5px;
    }
</style>

<h1>Economic Simulator</h1>

<div class="test-box">
    <p id="loadTest">Checking KineticGraphs...</p>
</div>

<script>
  if (typeof KG !== 'undefined') {
      document.getElementById('loadTest').innerHTML = '✓ KG JavaScript loaded successfully!';
      document.getElementById('loadTest').style.color = 'green';
  } else {
      document.getElementById('loadTest').innerHTML = '✗ KG JavaScript NOT loaded.';
      document.getElementById('loadTest').style.color = 'red';
  }
</script>

<h2>Consumer and Producer Surplus</h2>

<!-- KineticGraph Container -->
<div class="kg-container">
<script type="text/kg">
schema: EconSchema
params:
  - name: demandShift
    value: 0
    min: -2
    max: 2
    round: 0.1
  - name: supplyShift
    value: 0
    min: -2
    max: 2
    round: 0.1
layout:
  OneGraph:
    graph:
      objects:
        - EconLinearEquilibrium:
            name: ourEquilibrium
            demand:
              name: ourDemand
              xIntercept: 8 + params.demandShift
              invSlope: -1
              drag:
                - horizontal: demandShift
              surplus: {}
            supply:
              name: ourSupply
              yIntercept: 0 - params.supplyShift
              slope: 1
              drag:
                - horizontal: supplyShift
              surplus:
                fill: red
            equilibrium:
              droplines:
                vertical: "`Q_0 = ${calcs.ourEquilibrium.Q.toFixed(2)}`"
                horizontal: "`P_0 = ${calcs.ourEquilibrium.P.toFixed(2)}`"
</script>
</div>

<script>
  window.addEventListener('load', function() {
      console.log('Window loaded');
      if (typeof KG !== 'undefined') {
          console.log('KG is available');
      }
  });
</script>
{% endblock %}